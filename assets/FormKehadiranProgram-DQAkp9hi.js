import{_ as ge}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-Bm2K1jX0.js";import{_ as _e}from"./AdminLayoutPenganjur-9cndhfyN.js";import{z as ye,D as $e,r as I,q as ie,o as ve,e as N,L as xe,a as P,c as V,b as o,t as F,i as oe,E as ue,F as ce,k as de,f as De,w as le,g as re}from"./index-akeXVEdY.js";import{_ as Me}from"./Backdrop.vue_vue_type_script_setup_true_lang-Dkk3c35f.js";import{_ as ke}from"./ComponentCard.vue_vue_type_script_setup_true_lang-hLfoshuD.js";import"./Dropzone.vue_vue_type_style_index_0_lang-SraB36RU.js";import"./ePNJevent-BmfCIqR1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function me(b){return b&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b}var X={exports:{}},we=X.exports,fe;function be(){return fe||(fe=1,function(b,R){(function(y,$){b.exports=$()})(we,function(){var y=1e3,$=6e4,D=36e5,M="millisecond",B="second",O="minute",Y="hour",S="day",A="week",k="month",f="quarter",d="year",u="date",m="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,T=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,U={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var r=["th","st","nd","rd"],e=a%100;return"["+a+(r[(e-20)%10]||r[e]||r[0])+"]"}},E=function(a,r,e){var s=String(a);return!s||s.length>=r?a:""+Array(r+1-s.length).join(e)+a},pe={s:E,z:function(a){var r=-a.utcOffset(),e=Math.abs(r),s=Math.floor(e/60),t=e%60;return(r<=0?"+":"-")+E(s,2,"0")+":"+E(t,2,"0")},m:function a(r,e){if(r.date()<e.date())return-a(e,r);var s=12*(e.year()-r.year())+(e.month()-r.month()),t=r.clone().add(s,k),n=e-t<0,i=r.clone().add(s+(n?-1:1),k);return+(-(s+(e-t)/(n?t-i:i-t))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:k,y:d,w:A,d:S,D:u,h:Y,m:O,s:B,ms:M,Q:f}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},q="en",H={};H[q]=U;var ae="$isDayjsObject",te=function(a){return a instanceof Z||!(!a||!a[ae])},z=function a(r,e,s){var t;if(!r)return q;if(typeof r=="string"){var n=r.toLowerCase();H[n]&&(t=n),e&&(H[n]=e,t=n);var i=r.split("-");if(!t&&i.length>1)return a(i[0])}else{var l=r.name;H[l]=r,t=l}return!s&&t&&(q=t),t||!s&&q},p=function(a,r){if(te(a))return a.clone();var e=typeof r=="object"?r:{};return e.date=a,e.args=arguments,new Z(e)},c=pe;c.l=z,c.i=te,c.w=function(a,r){return p(a,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var Z=function(){function a(e){this.$L=z(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[ae]=!0}var r=a.prototype;return r.parse=function(e){this.$d=function(s){var t=s.date,n=s.utc;if(t===null)return new Date(NaN);if(c.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var i=t.match(v);if(i){var l=i[2]-1||0,h=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],l,i[3]||1,i[4]||0,i[5]||0,i[6]||0,h)):new Date(i[1],l,i[3]||1,i[4]||0,i[5]||0,i[6]||0,h)}}return new Date(t)}(e),this.init()},r.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},r.$utils=function(){return c},r.isValid=function(){return this.$d.toString()!==m},r.isSame=function(e,s){var t=p(e);return this.startOf(s)<=t&&t<=this.endOf(s)},r.isAfter=function(e,s){return p(e)<this.startOf(s)},r.isBefore=function(e,s){return this.endOf(s)<p(e)},r.$g=function(e,s,t){return c.u(e)?this[s]:this.set(t,e)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(e,s){var t=this,n=!!c.u(s)||s,i=c.p(e),l=function(C,x){var L=c.w(t.$u?Date.UTC(t.$y,x,C):new Date(t.$y,x,C),t);return n?L:L.endOf(S)},h=function(C,x){return c.w(t.toDate()[C].apply(t.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(x)),t)},g=this.$W,_=this.$M,w=this.$D,W="set"+(this.$u?"UTC":"");switch(i){case d:return n?l(1,0):l(31,11);case k:return n?l(1,_):l(0,_+1);case A:var j=this.$locale().weekStart||0,J=(g<j?g+7:g)-j;return l(n?w-J:w+(6-J),_);case S:case u:return h(W+"Hours",0);case Y:return h(W+"Minutes",1);case O:return h(W+"Seconds",2);case B:return h(W+"Milliseconds",3);default:return this.clone()}},r.endOf=function(e){return this.startOf(e,!1)},r.$set=function(e,s){var t,n=c.p(e),i="set"+(this.$u?"UTC":""),l=(t={},t[S]=i+"Date",t[u]=i+"Date",t[k]=i+"Month",t[d]=i+"FullYear",t[Y]=i+"Hours",t[O]=i+"Minutes",t[B]=i+"Seconds",t[M]=i+"Milliseconds",t)[n],h=n===S?this.$D+(s-this.$W):s;if(n===k||n===d){var g=this.clone().set(u,1);g.$d[l](h),g.init(),this.$d=g.set(u,Math.min(this.$D,g.daysInMonth())).$d}else l&&this.$d[l](h);return this.init(),this},r.set=function(e,s){return this.clone().$set(e,s)},r.get=function(e){return this[c.p(e)]()},r.add=function(e,s){var t,n=this;e=Number(e);var i=c.p(s),l=function(_){var w=p(n);return c.w(w.date(w.date()+Math.round(_*e)),n)};if(i===k)return this.set(k,this.$M+e);if(i===d)return this.set(d,this.$y+e);if(i===S)return l(1);if(i===A)return l(7);var h=(t={},t[O]=$,t[Y]=D,t[B]=y,t)[i]||1,g=this.$d.getTime()+e*h;return c.w(g,this)},r.subtract=function(e,s){return this.add(-1*e,s)},r.format=function(e){var s=this,t=this.$locale();if(!this.isValid())return t.invalidDate||m;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=c.z(this),l=this.$H,h=this.$m,g=this.$M,_=t.weekdays,w=t.months,W=t.meridiem,j=function(x,L,K,G){return x&&(x[L]||x(s,n))||K[L].slice(0,G)},J=function(x){return c.s(l%12||12,x,"0")},C=W||function(x,L,K){var G=x<12?"AM":"PM";return K?G.toLowerCase():G};return n.replace(T,function(x,L){return L||function(K){switch(K){case"YY":return String(s.$y).slice(-2);case"YYYY":return c.s(s.$y,4,"0");case"M":return g+1;case"MM":return c.s(g+1,2,"0");case"MMM":return j(t.monthsShort,g,w,3);case"MMMM":return j(w,g);case"D":return s.$D;case"DD":return c.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return j(t.weekdaysMin,s.$W,_,2);case"ddd":return j(t.weekdaysShort,s.$W,_,3);case"dddd":return _[s.$W];case"H":return String(l);case"HH":return c.s(l,2,"0");case"h":return J(1);case"hh":return J(2);case"a":return C(l,h,!0);case"A":return C(l,h,!1);case"m":return String(h);case"mm":return c.s(h,2,"0");case"s":return String(s.$s);case"ss":return c.s(s.$s,2,"0");case"SSS":return c.s(s.$ms,3,"0");case"Z":return i}return null}(x)||i.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(e,s,t){var n,i=this,l=c.p(s),h=p(e),g=(h.utcOffset()-this.utcOffset())*$,_=this-h,w=function(){return c.m(i,h)};switch(l){case d:n=w()/12;break;case k:n=w();break;case f:n=w()/3;break;case A:n=(_-g)/6048e5;break;case S:n=(_-g)/864e5;break;case Y:n=_/D;break;case O:n=_/$;break;case B:n=_/y;break;default:n=_}return t?n:c.a(n)},r.daysInMonth=function(){return this.endOf(k).$D},r.$locale=function(){return H[this.$L]},r.locale=function(e,s){if(!e)return this.$L;var t=this.clone(),n=z(e,s,!0);return n&&(t.$L=n),t},r.clone=function(){return c.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},a}(),ne=Z.prototype;return p.prototype=ne,[["$ms",M],["$s",B],["$m",O],["$H",Y],["$W",S],["$M",k],["$y",d],["$D",u]].forEach(function(a){ne[a[1]]=function(r){return this.$g(r,a[0],a[1])}}),p.extend=function(a,r){return a.$i||(a(r,Z,p),a.$i=!0),p},p.locale=z,p.isDayjs=te,p.unix=function(a){return p(1e3*a)},p.en=H[q],p.Ls=H,p.p={},p})}(X)),X.exports}var Se=be();const Q=me(Se);var ee={exports:{}},Oe=ee.exports,he;function Ye(){return he||(he=1,function(b,R){(function(y,$){b.exports=$()})(Oe,function(){return function(y,$){$.prototype.isSameOrBefore=function(D,M){return this.isSame(D,M)||this.isBefore(D,M)}}})}(ee)),ee.exports}var Te=Ye();const Be=me(Te),Le={key:0},He={key:1},je=["value"],Ce={class:"min-w-full"},Fe={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ie={class:"px-5 py-4 sm:px-6"},Pe={class:"flex items-center gap-3"},Re={class:"w-10 h-10 overflow-hidden rounded-full flex-shrink-0"},Ae=["alt"],Ue={class:"block font-medium text-gray-800 text-theme-sm dark:text-white/90"},We={class:"block text-gray-500 text-theme-xs dark:text-gray-400"},Ne={class:"px-5 py-4 sm:px-6"},Ve={class:"text-gray-500 text-theme-sm dark:text-gray-400"},Ee={class:"px-5 py-4 sm:px-6"},qe={class:"text-gray-500 text-theme-sm dark:text-gray-400"},Je={class:"px-5 py-4 sm:px-6"},Ke={class:"text-gray-500 text-theme-sm dark:text-gray-400"},ze={class:"px-5 py-4 sm:px-6"},Ze=["onUpdate:modelValue","onChange"],se=10,Ge={__name:"DefaultInputsProgramKehadiran",setup(b){const R=ye();$e(),Q.extend(Be);const y=I({}),$=I([]),D=I(null),M=I([]);function B(f,d){const u=[];let m=Q(f);const v=Q(d);for(;m.isSameOrBefore(v);)u.push(m.format("YYYY-MM-DD")),m=m.add(1,"day");return u}const O=I(!0),Y=f=>Q(f,"DD/MM/YYYY").format("YYYY-MM-DD"),S=I(1),A=ie(()=>{const f=(S.value-1)*se;return M.value.slice(f,f+se)});ie(()=>Math.ceil(participant.value.length/se)),ve(async()=>{const f=R.params.id;try{const m=await N.get(`/api/programs/${f}`);y.value=m.data,console.log("programRes:",m),console.log("Original date_from:",y.value.date_from),console.log("Original date_to:",y.value.date_to);const v=Y(y.value.date_from),T=Y(y.value.date_to);console.log("Formatted date_from:",v),console.log("Formatted date_to:",T),$.value=B(v,T),console.log("Available Dates:",$.value),O.value=!1;const U=await N.get(`/api/programs/${f}/participants`);M.value=U.data.filter(E=>E.is_walkin===0),console.log(M)}catch(m){console.error(m)}const u=(await N.get(`/api/attendance/${f}?date=${D.value}`)).data;M.value=participantResponse.data.map(m=>{const v=u.some(T=>T.user_id===m.user_id&&T.is_present);return{...m,is_present:v}})});const k=async f=>{if(!D.value){alert("Sila pilih tarikh terlebih dahulu.");return}try{f.is_present?await N.post("/api/attendance/manual",{program_id:y.value.id,user_id:f.user.id,date:D.value,attendances:[{participant_id:f.id,is_present:1}]}):await N.post("/api/attendance/manual/delete",{program_id:y.value.id,date:D.value,user_id:f.user.id}),alert("Status kehadiran dikemaskini.")}catch(d){console.error(d),alert("Gagal mengemaskini kehadiran.")}};return xe(D,async f=>{if(f)try{const d=R.params.id,m=(await N.get(`/api/attendance/${d}?date=${f}`)).data;M.value=M.value.map(v=>{const T=m.some(U=>U.user_id===v.user_id&&!!U.is_present);return{...v,is_present:T}})}catch(d){console.error("Failed to reload attendance for new date:",d)}}),(f,d)=>O.value?(P(),V("div",Le,"Loading program...")):(P(),V("div",He,[o("h1",null,F(y.value.program_name),1),d[3]||(d[3]=o("label",null,"Pilih Tarikh:",-1)),oe(o("select",{"onUpdate:modelValue":d[0]||(d[0]=u=>D.value=u),class:"mb-4 mt-2 ml-4 dark:bg-dark-900 h-11 rounded-lg border border-gray-300 bg-transparent px-2 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},[(P(!0),V(ce,null,de($.value,u=>(P(),V("option",{key:u,value:u},F(u),9,je))),128))],512),[[ue,D.value]]),o("table",Ce,[d[2]||(d[2]=o("thead",null,[o("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[o("th",{class:"px-5 py-3 text-left w-3/11 sm:px-6"},[o("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Nama dan Emel")]),o("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[o("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"myKad")]),o("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[o("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Jawatan")]),o("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[o("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Jabatan")]),o("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[o("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Tindakan")])])],-1)),o("tbody",Fe,[(P(!0),V(ce,null,de(A.value,(u,m)=>(P(),V("tr",{key:m,class:"border-t border-gray-100 dark:border-gray-800"},[o("td",Ie,[o("div",Pe,[o("div",Re,[o("img",{src:Me,alt:u.user.name},null,8,Ae)]),o("div",null,[o("span",Ue,F(u.user.name),1),o("span",We,F(u.user.email),1)])])]),o("td",Ne,[o("p",Ve,F(u.user.ic_no),1)]),o("td",Ee,[o("p",qe,F(u.user.position),1)]),o("td",Je,[o("p",Ke,F(u.user.department),1)]),o("td",ze,[oe(o("select",{"onUpdate:modelValue":v=>u.is_present=v,onChange:v=>k(u)},d[1]||(d[1]=[o("option",{value:!0},"Hadir",-1),o("option",{value:!1},"Tidak Hadir",-1)]),40,Ze),[[ue,u.is_present]])])]))),128))])])]))}},Qe={class:"grid grid-cols-1 gap-6"},Xe={class:"space-y-6"},ut={__name:"FormKehadiranProgram",setup(b){const R=I("Kemaskini Program");return(y,$)=>(P(),De(_e,null,{default:le(()=>[re(ge,{pageTitle:R.value},null,8,["pageTitle"]),o("div",Qe,[o("div",Xe,[re(ke,{title:"Daftar Kehadiran Manual "},{default:le(()=>[re(Ge)]),_:1})])])]),_:1}))}};export{ut as default};
